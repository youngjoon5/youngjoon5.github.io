<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>Young Joon Oh</title>

    <!-- Bootstrap Core CSS -->
    <link href="vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">

    <!-- Theme CSS -->
    <link href="css/clean-blog.min.css" rel="stylesheet">

    <!-- Custom Fonts -->
    <link href="vendor/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">
    <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

</head>

<body>

    <!-- Navigation -->
    <nav class="navbar navbar-default navbar-custom navbar-fixed-top">
        <div class="container-fluid">
            <!-- Brand and toggle get grouped for better mobile display -->
            <div class="navbar-header page-scroll">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
                    <span class="sr-only">Toggle navigation</span>
                    Menu <i class="fa fa-bars"></i>
                </button>
                <a class="navbar-brand" href="index.html">Home</a>
            </div>

            <!-- Collect the nav links, forms, and other content for toggling -->
            <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="about.html">About</a>
                    </li>
                    <li>
                        <a href="research.html">My Research</a>
                    </li>
                    <li>
                        <a href="post.html">Computational Social Science Post</a>
                    </li>
                    <li>
                        <a href="teaching.html">Teaching</a>
                    </li>
                </ul>
            </div>
            <!-- /.navbar-collapse -->
        </div>
        <!-- /.container -->
    </nav>





    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header class="intro-header" style="background-image: url('img/fall1.jpg')">
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <div class="post-heading">
                        <h1>Computational Social Science Post</h1>
                        <h2 class="subheading">Tips on R, Netlogo, and Python</h2>
                       <!--  <span class="meta"><i>&emsp;Posted on Dec.1, 2020</i></span>   -->
                    </div>
                </div>
            </div>
        </div>
    </header>


 

  <!--For making Rmarkdown style <code>  
        <style type="text/css">
            code {
             color: inherit;
             background-color: rgba(0, 0, 0, 0.04);
                  }
        </style>

   --> 



     <!--                      Post Content                   -->
    <!--                      Post Content                   -->
   <!--                      Post Content                   -->







<article>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    

                    <div id="pynetlogo"><!-- id for refering this part   -->

                    <h1> PyNetlogo Tutorial </h1>
                       <span class="meta"><i>&emsp;Posted on Dec.16, 2020</i></span>
                    
                    <p> PyNetlogo is a python package to link Netlog to Python. The latest version is 0.3. 
                        I do not think it is well managed after the release of version 0.3.
                        There are three important webpages as follows:</br>
                        
                        <table>
                        <a href="http://jasss.soc.surrey.ac.uk/21/2/4.html"><mark>Paper</mark> : PyNetLogo: Linking NetLogo with Python </a></br>
                        <a href="https://pynetlogo.readthedocs.io/en/latest/">PyNetlogo Homepage </a></br>
                        <a href="https://github.com/quaquel/pyNetLogo">PyNetlogo Github</a></br></br>
                        and One more:    </br> 
                        <a href="https://www.youtube.com/watch?v=qLBzT85Z-aM">My tutorial for PyNetlogo</a></br>
                        </table>
                    </p>


                    <h3> Install and Virtual Environment</h3>
                    <P> I strongly recommend creating a virtual environment for a new package. 
                        JPype package is more stable in Pyhton 3.8 or older. 

<pre><code>conda create -n netlogo-env python=3.8

# For JPype
conda install -c conda-forge jpype1
   
# For PyNetLogo
pip install pynetlogo </code></pre>
                    
                    </P>


                            
                     <h3> Import Libraries</h3>
<p>
<pre><code>
import pandas as pd
import numpy as np
from scipy import stats
import matplotlib.pyplot as plt
import seaborn as sns
import pyNetLogo


sns.set_style('white')
sns.set_context('talk')

%matplotlib inline   
</code></pre>
</p>


                <h3> Get Data from Netlogo simulation: <code>.command</code> and <code>.report</code></h3>

<p>
<pre><code>
# open Netlogo
netlogo = pyNetLogo.NetLogoLink(gui=True)

# Load the Model
netlogo.load_model('C:/Program Files/NetLogo 6.1.1/.../Wolf Sheep Predation.nlogo')

# Setup and Choose  model-version = "sheep-wolves-grass"
netlogo.command('setup')


# Get the coordinates of agents(sheep) from Netlogo
x = netlogo.report('map [s -> [xcor] of s] sort sheep')
y = netlogo.report('map [s -> [ycor] of s] sort sheep') 


# Make a plot
fig, ax = plt.subplots(1)
ax.scatter(x, y, s=4)
ax.set_xlabel('xcor')
ax.set_ylabel('ycor')
ax.set_aspect('equal')
fig.set_size_inches(5,5)
plt.show()
</code></pre>


    <figure>
        <img src="img/post/scatter.png" style="width:30%">
    </figure>

</p>



    <h3> Repeat the model simulation: Using <code>.command</code> or <code>.repeat_report</code></h3>

<p>
<pre><code>
# Run 100ticks 
netlogo.command('repeat 100 [go]')

# or

# Run 100 ticks and Report 'count wolves'
netlogo.repeat_report(['count wolves'], 100, go='go')
</code></pre>

</p>



<h3> Import data to the Netlogo model : <code>.write_NetLogo_attriblist</code></h3>

<p>
<pre><code>
# ex_data is a pandas DataFrame having three columns : col1, col2, and col3.
ex_data[['col1','col2','col3']]

# Import the data to col1, col2 and col3 attributes of the 'breed'
netlogo.write_NetLogo_attriblist(ex_data[['col1','col2','col3']], 'breed')
</code></pre>

</p>



<h3> <code>.patch_report</code> is not Working.</h3>

To get data from patches, we need to use <code>.patch_report</code>. 
But it gives an error message. Alternatively, I use <code>.report</code>.

<p>
<pre><code>
# Error
countdown_df = netlogo.patch_report('countdown')

# Alternative way
countdown_df=netlogo.report('map [s -> [countdown] of s] sort patches')

# Reshape for 51 by 51 square
countdown_df=countdown_df.reshape(51,51) 

# Convert to DataFrame
countdown_df = pd.DataFrame(countdown_df)


# Change index and column names
countdown_df.columns=[list(range(-25,26))]
countdown_df.index=[list(range(-25,26))]

# Make a plot
fig, ax = plt.subplots(1)
patches = sns.heatmap(countdown_df, xticklabels=5, yticklabels=5,
                      cbar_kws={'label':'countdown'}, ax=ax) 
ax.set_xlabel('pxcor')
ax.set_ylabel('pycor')
ax.set_aspect('equal')
fig.set_size_inches(20,10)
plt.show()

</code></pre>


<figure>
        <img src="img/post/patch.png" style="width:70%">
    </figure>

</p>





<h3> Export patch data and change patch data : <code>.to_excel</code> and <code>.patch_set</code>></h3>
<p>
<pre><code>
countdown_df.to_excel('countdown.xlsx')

netlogo.patch_set('countdown', countdown_df.max()-countdown_df)
</code></pre>
</p>







<!---------------------------------- Begin List 


                            <ol start="2" style="list-style-type: decimal">
                                <li>Create a <strong>virtual environment</strong>.</li> </ol>  

<pre><code>conda create -n tensorflow-env
   
# If you want remove the environment
   conda remove -n tensorflow-env --all  </code></pre>


                            

                            



                             <ol start="2" style="list-style-type: decimal">
                                <li>In the environment, install <code>tensorflow-gpu</code> or <code>tensorflow</code> and check it.</li> </ol>

<pre><code>conda activate tensorflow-env

conda install tensorflow-gpu

 # Check
   import tensorflow as tf
   tf.__version__ </code></pre>






                    


                            <ol start="3" style="list-style-type: decimal">
                                    <li>If you want to use <code>tensorflow</code> in the <strong>Jupyter notebook</strong>, install <strong>ipython</strong> and <strong>Jupyter notebook</strong> in the environment. After checking <code>tensorflow</code> in the <strong>ipython</strong>, then use <code>ctrl + d</code> to exit.</li>  </ol>
                                        
<pre><code>conda install ipython
conda install jupyter notebook      

# Check in the jupyter notebook </code></pre>

 



 End List           ------------------------>
                    

 







<!-- blockquote 
<blockquote>The dreams of yesterday are the hopes of today and the reality of tomorrow. Science has not yet mastered prophecy. We predict too much for the next year and yet far too little for the next ten.</blockquote>

<mark> test</mark>
-->




<!-- Begin : pager back to Computational social science post -->
<ul class="pager">
                        <li class="next">
                            <a href="post.html">Return to Post List &rarr;</a>
                        </li>
                    </ul>
<!-- End : pager back to Computational social science post -->
                  


                    <br></br>

                  </div>
                </div>
            </div>
        </div>


    </article>

    <hr>




   






    <!--            Footer            -->
    <footer>
        <div class="container">
            <div class="row">
                <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                    <ul class="list-inline text-center">
                                                <li>
                            <a href="https://www.youtube.com/user/yjoon5">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-youtube fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                        <li>
                            <a href="https://github.com/youngjoon5">
                                <span class="fa-stack fa-lg">
                                    <i class="fa fa-circle fa-stack-2x"></i>
                                    <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                                </span>
                            </a>
                        </li>
                    </ul>
                    <p class="copyright text-muted">Copyright &copy; Start Bootstrap 2016</p>
                </div>
            </div>
        </div>
    </footer>







    <!-- jQuery -->
    <script src="vendor/jquery/jquery.min.js"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="vendor/bootstrap/js/bootstrap.min.js"></script>

    <!-- Contact Form JavaScript -->
    <script src="js/jqBootstrapValidation.js"></script>
    <script src="js/contact_me.js"></script>

    <!-- Theme JavaScript -->
    <script src="js/clean-blog.min.js"></script>

</body>

</html>
